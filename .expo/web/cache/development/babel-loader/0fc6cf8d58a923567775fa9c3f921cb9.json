{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/franckcaget/Desktop/frosty/views/RepositoryLines.tsx\";\n\nimport React, { useState } from 'react';\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport RepositoryLine from \"./RepositoryLine\";\nimport AsyncStorage from '@react-native-community/async-storage';\nimport { COLORS_THEME, STORAGE_KEY } from \"../utils/constants\";\nimport { getRepos } from \"../logic/dataFetch\";\n\nvar RepositoryLines = function RepositoryLines(_ref) {\n  var initialRepositories = _ref.initialRepositories,\n      starredRepositories = _ref.starredRepositories,\n      navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(starredRepositories),\n      _useState2 = _slicedToArray(_useState, 2),\n      _starredRepositories = _useState2[0],\n      setStarredRepositories = _useState2[1];\n\n  var _useState3 = useState(initialRepositories),\n      _useState4 = _slicedToArray(_useState3, 2),\n      _repositories = _useState4[0],\n      setRepositories = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      _loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var endOfList = function endOfList() {\n    if (!_loading) {\n      setLoading(true);\n      getRepos(_repositories, setRepositories);\n      setTimeout(function () {\n        setLoading(false);\n      }, 1000);\n    }\n  };\n\n  var footer = function footer() {\n    return _loading ? React.createElement(ActivityIndicator, {\n      style: {\n        flexGrow: 1\n      },\n      size: \"large\",\n      color: COLORS_THEME.info,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 27\n      }\n    }) : React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 114\n      }\n    });\n  };\n\n  var saveData = function saveData(id) {\n    var _starredRepositories2, starredRepositoriesParsed, index;\n\n    return _regeneratorRuntime.async(function saveData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(STORAGE_KEY));\n\n          case 3:\n            _starredRepositories2 = _context.sent;\n            starredRepositoriesParsed = [];\n            if (_starredRepositories2) starredRepositoriesParsed = JSON.parse(_starredRepositories2);\n            index = starredRepositoriesParsed.indexOf(id);\n\n            if (index > -1) {\n              starredRepositoriesParsed.splice(index, 1);\n            } else {\n              starredRepositoriesParsed.push(id);\n            }\n\n            setStarredRepositories(starredRepositoriesParsed);\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(starredRepositoriesParsed)));\n\n          case 11:\n            _context.next = 16;\n            break;\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context[\"catch\"](0);\n            console.log('There was an error saving the product');\n\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 13]], Promise);\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }\n  }, _repositories.length), React.createElement(FlatList, {\n    contentContainerStyle: {\n      flexGrow: 1\n    },\n    data: _repositories,\n    renderItem: function renderItem(_ref2) {\n      var item = _ref2.item;\n      return React.createElement(RepositoryLine, {\n        repository: item,\n        isStarred: _starredRepositories.includes(item.id),\n        toggleIsStarred: saveData,\n        navigation: navigation,\n        route: route,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 75\n        }\n      });\n    },\n    ListFooterComponent: function ListFooterComponent() {\n      return footer();\n    },\n    ListFooterComponentStyle: styles.loader,\n    keyExtractor: function keyExtractor(item) {\n      return item.id + '';\n    },\n    onEndReachedThreshold: 0.01,\n    onEndReached: function onEndReached(info) {\n      endOfList();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }\n  }));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    display: \"flex\",\n    flex: 1,\n    backgroundColor: COLORS_THEME.bg_secondary\n  },\n  loader: {\n    display: \"flex\",\n    flexGrow: 1,\n    alignContent: \"center\",\n    marginTop: 16,\n    marginBottom: 16\n  }\n});\nexport default RepositoryLines;","map":{"version":3,"sources":["/Users/franckcaget/Desktop/frosty/views/RepositoryLines.tsx"],"names":["React","useState","RepositoryLine","AsyncStorage","COLORS_THEME","STORAGE_KEY","getRepos","RepositoryLines","initialRepositories","starredRepositories","navigation","route","_starredRepositories","setStarredRepositories","_repositories","setRepositories","_loading","setLoading","endOfList","setTimeout","footer","flexGrow","info","saveData","id","getItem","starredRepositoriesParsed","JSON","parse","index","indexOf","splice","push","setItem","stringify","console","log","styles","container","length","item","includes","loader","StyleSheet","create","display","flex","backgroundColor","bg_secondary","alignContent","marginTop","marginBottom"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { SafeAreaView, View, FlatList, StyleSheet, ActivityIndicator, Text } from 'react-native';\nimport { RepositoryLightModel } from '../model/repository_light';\nimport RepositoryLine from './RepositoryLine';\nimport AsyncStorage from '@react-native-community/async-storage';\nimport { COLORS_THEME, STORAGE_KEY } from '../utils/constants'\nimport { getRepos } from '../logic/dataFetch';\n\n\nconst RepositoryLines = ({ initialRepositories, starredRepositories, navigation, route }: { initialRepositories: RepositoryLightModel[], starredRepositories: string[], navigation: any, route: any }) => {\n\n    const [_starredRepositories, setStarredRepositories] = useState<string[]>(starredRepositories);\n    const [_repositories, setRepositories] = useState<RepositoryLightModel[]>(initialRepositories);\n    const [_loading, setLoading] = useState<boolean>(false);\n\n    const endOfList = () => {\n        if (!_loading) {\n            setLoading(true);\n            getRepos(_repositories, setRepositories);\n            setTimeout(() => {\n                //to show the loader\n                setLoading(false);\n            }, 1000);\n        }\n    }\n\n    const footer = () => {\n        return _loading ? <ActivityIndicator style={{ flexGrow: 1 }} size=\"large\" color={COLORS_THEME.info} /> : <View></View>\n    }\n\n    const saveData = async (id: string) => {\n        try {\n            const starredRepositories = await AsyncStorage.getItem(STORAGE_KEY);\n            let starredRepositoriesParsed = [];\n            if (starredRepositories)\n                starredRepositoriesParsed = JSON.parse(starredRepositories);\n\n            const index = starredRepositoriesParsed.indexOf(id);\n            if (index > -1) {\n                starredRepositoriesParsed.splice(index, 1);\n            } else {\n                starredRepositoriesParsed.push(id);\n            }\n            setStarredRepositories(starredRepositoriesParsed);\n            await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(starredRepositoriesParsed));\n        } catch (e) {\n            console.log('There was an error saving the product');\n        }\n    }\n\n    return (\n        <SafeAreaView style={styles.container}>\n            <Text>{_repositories.length}</Text>\n            <FlatList\n                contentContainerStyle={{ flexGrow: 1 }}\n                data={_repositories}\n                renderItem={({ item }: { item: RepositoryLightModel }) => <RepositoryLine repository={item} isStarred={_starredRepositories.includes(item.id)} toggleIsStarred={saveData} navigation={navigation} route={route} />}\n                ListFooterComponent={() => footer()}\n                ListFooterComponentStyle={styles.loader}\n                keyExtractor={(item: { id: string; }) => item.id + ''}\n                onEndReachedThreshold={0.01}\n                onEndReached={info => {\n                    endOfList();\n                }}\n            />\n        </SafeAreaView>\n    );\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        display: \"flex\",\n        flex: 1,\n        backgroundColor: COLORS_THEME.bg_secondary,\n\n    },\n    loader: {\n        display: \"flex\",\n        flexGrow: 1,\n        alignContent: \"center\",\n        marginTop: 16,\n        marginBottom: 16,\n\n    }\n});\n\n\nexport default RepositoryLines;"]},"metadata":{},"sourceType":"module"}